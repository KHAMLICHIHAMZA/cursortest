<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Release Report V1 - MalocAuto</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      font-size: 11px;
      line-height: 1.4;
      color: #1a1a1a;
      padding: 20px 40px;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    h1 {
      font-size: 24px;
      color: #1e40af;
      border-bottom: 3px solid #1e40af;
      padding-bottom: 10px;
      margin-bottom: 15px;
    }
    
    h2 {
      font-size: 16px;
      color: #1e40af;
      margin-top: 25px;
      margin-bottom: 10px;
      border-bottom: 1px solid #ddd;
      padding-bottom: 5px;
    }
    
    h3 {
      font-size: 13px;
      color: #374151;
      margin-top: 15px;
      margin-bottom: 8px;
    }
    
    h4 {
      font-size: 12px;
      color: #4b5563;
      margin-top: 12px;
      margin-bottom: 6px;
    }
    
    p {
      margin-bottom: 8px;
    }
    
    .header-info {
      background: #f3f4f6;
      padding: 12px;
      border-radius: 6px;
      margin-bottom: 20px;
    }
    
    .header-info p {
      margin: 4px 0;
    }
    
    .warning {
      background: #fef3c7;
      border-left: 4px solid #f59e0b;
      padding: 10px;
      margin: 10px 0;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 10px 0 15px 0;
      font-size: 10px;
    }
    
    th, td {
      border: 1px solid #d1d5db;
      padding: 6px 8px;
      text-align: left;
      vertical-align: top;
    }
    
    th {
      background: #1e40af;
      color: white;
      font-weight: 600;
    }
    
    tr:nth-child(even) {
      background: #f9fafb;
    }
    
    tr:hover {
      background: #e5e7eb;
    }
    
    .status-existe {
      color: #059669;
      font-weight: bold;
    }
    
    .status-partiel {
      color: #d97706;
      font-weight: bold;
    }
    
    .status-manque {
      color: #dc2626;
      font-weight: bold;
    }
    
    .status-stub {
      color: #6b7280;
      font-weight: bold;
    }
    
    code {
      background: #e5e7eb;
      padding: 1px 4px;
      border-radius: 3px;
      font-family: 'Consolas', monospace;
      font-size: 9px;
    }
    
    pre {
      background: #1f2937;
      color: #e5e7eb;
      padding: 12px;
      border-radius: 6px;
      overflow-x: auto;
      font-size: 9px;
      margin: 10px 0;
    }
    
    .priority-critical {
      background: #fecaca;
      color: #991b1b;
    }
    
    .priority-high {
      background: #fed7aa;
      color: #9a3412;
    }
    
    .priority-medium {
      background: #fef08a;
      color: #854d0e;
    }
    
    .priority-low {
      background: #d1fae5;
      color: #065f46;
    }
    
    .section {
      page-break-inside: avoid;
    }
    
    .page-break {
      page-break-before: always;
    }
    
    ul {
      margin-left: 20px;
      margin-bottom: 10px;
    }
    
    li {
      margin-bottom: 3px;
    }
    
    .toc {
      background: #f3f4f6;
      padding: 15px;
      border-radius: 6px;
      margin-bottom: 20px;
    }
    
    .toc ul {
      list-style: none;
      margin-left: 0;
    }
    
    .toc li {
      margin-bottom: 5px;
    }
    
    .toc a {
      color: #1e40af;
      text-decoration: none;
    }
    
    @media print {
      body {
        padding: 10px 20px;
        font-size: 9px;
      }
      
      h1 {
        font-size: 18px;
      }
      
      h2 {
        font-size: 14px;
      }
      
      table {
        font-size: 8px;
      }
      
      .no-print {
        display: none;
      }
    }
  </style>
</head>
<body>

<h1>üìã RELEASE REPORT V1 - MalocAuto</h1>

<div class="header-info">
  <p><strong>Date d'analyse :</strong> 28 janvier 2026</p>
  <p><strong>R√©f√©rence Git :</strong> Commit <code>bac0280</code> (03/01/2026) ‚Äî "feat: Implementation complete - Backend, Frontends, Mobile Agent avec todos compl√©t√©s et optimisations planning"</p>
</div>

<div class="warning">
  <strong>‚ö†Ô∏è Note :</strong> Aucun tag Git n'existe (v1, release/v1, etc.). La r√©f√©rence V1 est bas√©e sur le commit <code>bac0280</code> qui pr√©c√®de les 2 commits du Sprint 1 (28/01/2026).
</div>

<div class="toc">
  <h3>Table des mati√®res</h3>
  <ul>
    <li>1. Analyse Git</li>
    <li>2. Inventaire fonctionnalit√©s "r√©elles"</li>
    <li>3. Endpoints Backend</li>
    <li>4. Configuration / ENV</li>
    <li>5. Livrables (A-D)</li>
  </ul>
</div>

<h2>1. ANALYSE GIT</h2>

<h3>1.1 Derniers commits (3 commits au total)</h3>

<table>
  <tr>
    <th>Hash</th>
    <th>Date</th>
    <th>Auteur</th>
    <th>Message</th>
    <th>Impact</th>
  </tr>
  <tr>
    <td><code>a72111b</code></td>
    <td>2026-01-28</td>
    <td>Hamza</td>
    <td>feat: add password reset and improve mobile offline sync</td>
    <td>163 fichiers, +6436/-14357</td>
  </tr>
  <tr>
    <td><code>de8aafe</code></td>
    <td>2026-01-28</td>
    <td>Hamza</td>
    <td>feat: unify planning filters and event colors</td>
    <td>11 fichiers, +3069/-521</td>
  </tr>
  <tr>
    <td><code>bac0280</code></td>
    <td>2026-01-03</td>
    <td>Hamza</td>
    <td>feat: Implementation complete</td>
    <td>V1 BASE</td>
  </tr>
</table>

<h3>1.2 Diff r√©sum√© par application (depuis V1 base)</h3>

<table>
  <tr>
    <th>Application</th>
    <th>Fichiers modifi√©s</th>
    <th>Lignes +</th>
    <th>Lignes -</th>
    <th>Ajouts notables</th>
    <th>Suppressions</th>
  </tr>
  <tr>
    <td><strong>backend/</strong></td>
    <td>~45</td>
    <td>~1200</td>
    <td>~300</td>
    <td>forgot-password.dto.ts, SECURITE_JWT.md, scripts</td>
    <td>-</td>
  </tr>
  <tr>
    <td><strong>frontend-admin/</strong></td>
    <td>~14</td>
    <td>~800</td>
    <td>~200</td>
    <td>PlanningBoard.tsx, ForgotPassword.tsx, ResetPassword.tsx</td>
    <td>d√©pendances FullCalendar</td>
  </tr>
  <tr>
    <td><strong>frontend-agency/</strong></td>
    <td>~16</td>
    <td>~1100</td>
    <td>~100</td>
    <td>PlanningBoard.tsx, DatePicker.tsx, ForgotPassword.tsx</td>
    <td>-</td>
  </tr>
  <tr>
    <td><strong>frontend-web/</strong></td>
    <td>~15</td>
    <td>~900</td>
    <td>~700</td>
    <td>PlanningBoard.tsx, forgot-password/page.tsx</td>
    <td>refactoring clients/new</td>
  </tr>
  <tr>
    <td><strong>mobile-agent/</strong></td>
    <td>~10</td>
    <td>~600</td>
    <td>~100</td>
    <td>ForgotPasswordScreen.tsx, offline.service.ts (dedup)</td>
    <td>-</td>
  </tr>
  <tr>
    <td><strong>scripts/</strong></td>
    <td>~12</td>
    <td>~1500</td>
    <td>~200</td>
    <td>PowerShell scripts DevOps</td>
    <td>-</td>
  </tr>
  <tr>
    <td><strong>docs (root)</strong></td>
    <td>~30</td>
    <td>~1500</td>
    <td>~8000</td>
    <td>APPLICATIONS_DETAILS.md, PORTS_APPLICATIONS.md</td>
    <td>30+ fichiers .md obsol√®tes</td>
  </tr>
</table>

<div class="page-break"></div>

<h2>2. INVENTAIRE FONCTIONNALIT√âS "R√âELLES"</h2>

<h3>2.1 BACKEND</h3>

<table>
  <tr>
    <th>Module / Feature</th>
    <th>Statut</th>
    <th>Preuve (fichiers)</th>
    <th>Endpoints</th>
    <th>Notes / Risques</th>
  </tr>
  <tr>
    <td>Auth - Login</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>auth.controller.ts:16-20</code></td>
    <td><code>POST /auth/login</code></td>
    <td>JWT + refresh token</td>
  </tr>
  <tr>
    <td>Auth - Refresh Token</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>auth.controller.ts:22-26</code></td>
    <td><code>POST /auth/refresh</code></td>
    <td>RefreshToken model en DB</td>
  </tr>
  <tr>
    <td>Auth - Forgot Password</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>auth.controller.ts:42-46</code>, <code>forgot-password.dto.ts</code></td>
    <td><code>POST /auth/forgot-password</code></td>
    <td>Email SMTP requis</td>
  </tr>
  <tr>
    <td>Auth - Reset Password</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>auth.controller.ts:36-40</code></td>
    <td><code>POST /auth/reset-password</code></td>
    <td>Token 1h expiry</td>
  </tr>
  <tr>
    <td>Auth - Get Me</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>auth.controller.ts:28-34</code></td>
    <td><code>GET /auth/me</code></td>
    <td>JwtAuthGuard</td>
  </tr>
  <tr>
    <td>RBAC - RolesGuard</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>roles.guard.ts</code>, <code>roles.decorator.ts</code></td>
    <td>Global</td>
    <td>SUPER_ADMIN, COMPANY_ADMIN, AGENCY_MANAGER, AGENT</td>
  </tr>
  <tr>
    <td>RBAC - PermissionGuard</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>permission.guard.ts</code></td>
    <td>Par endpoint</td>
    <td>READ, WRITE, FULL</td>
  </tr>
  <tr>
    <td>RequireModuleGuard</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>require-module.guard.ts:48-145</code></td>
    <td>Global</td>
    <td>V√©rifie CompanyModule + AgencyModule</td>
  </tr>
  <tr>
    <td>RequireActiveCompanyGuard</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>require-active-company.guard.ts</code></td>
    <td>Global</td>
    <td>Bloque si Company SUSPENDED/DELETED</td>
  </tr>
  <tr>
    <td>RequireActiveAgencyGuard</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>require-active-agency.guard.ts</code></td>
    <td>Global</td>
    <td>Bloque si Agency SUSPENDED</td>
  </tr>
  <tr>
    <td>ReadOnlyGuard</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>read-only.guard.ts:27-65</code></td>
    <td>Global</td>
    <td>Env var READ_ONLY_MODE</td>
  </tr>
  <tr>
    <td>Bookings - CRUD</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>booking.controller.ts</code>, <code>booking.service.ts</code></td>
    <td><code>/bookings</code></td>
    <td>+ check-in, check-out, financial-closure</td>
  </tr>
  <tr>
    <td>Bookings - Statuts &amp; transitions</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>schema.prisma</code> enum, <code>booking.service.ts:709‚Äì722</code></td>
    <td>update()</td>
    <td>DRAFT‚ÜíPENDING,CANCELLED; PENDING‚ÜíCONFIRMED,CANCELLED; CONFIRMED‚ÜíIN_PROGRESS,CANCELLED,NO_SHOW; IN_PROGRESS‚ÜíRETURNED,LATE; LATE‚ÜíRETURNED.</td>
  </tr>
  <tr>
    <td>Bookings - Permis R1.3</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>booking.service.ts:70-105, 296-350</code></td>
    <td>create, checkIn</td>
    <td>Bloque si permis expir√© avant fin location</td>
  </tr>
  <tr>
    <td>Bookings - Pr√©paration R2.2</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>booking.service.ts:120-170</code></td>
    <td>create</td>
    <td>preparationTimeMinutes par Agency</td>
  </tr>
  <tr>
    <td>Bookings - Caution R3</td>
    <td class="status-partiel">‚ö†Ô∏è PARTIEL</td>
    <td><code>schema.prisma:510-514</code></td>
    <td>checkIn, checkOut</td>
    <td>Fields pr√©sents, validation manuelle</td>
  </tr>
  <tr>
    <td>Bookings - Retard R4</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>booking.service.ts:536-562</code></td>
    <td>checkOut</td>
    <td>Calcul auto ‚â§1h=25%, ‚â§2h=50%, >4h=100%</td>
  </tr>
  <tr>
    <td>Bookings - Override Late Fee</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>booking.controller.ts:109-119</code></td>
    <td><code>PATCH /bookings/:id/late-fee</code></td>
    <td>Agency Manager only + justification</td>
  </tr>
  <tr>
    <td>Bookings - Financial Closure</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>booking.service.ts:1019-1104</code></td>
    <td><code>POST /bookings/:id/financial-closure</code></td>
    <td>Bloqu√© si DISPUTED</td>
  </tr>
  <tr>
    <td>Planning - GET</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>planning.controller.ts:17-313</code></td>
    <td><code>GET /planning</code></td>
    <td>Retourne resources + events</td>
  </tr>
  <tr>
    <td>Planning - Check Availability</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>planning.controller.ts:315-337</code></td>
    <td><code>POST /planning/check-availability</code></td>
    <td>detectConflicts</td>
  </tr>
  <tr>
    <td>Vehicles - CRUD</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>vehicle.controller.ts</code></td>
    <td><code>/vehicles</code></td>
    <td>+ imageUrl, horsepower, color</td>
  </tr>
  <tr>
    <td>Clients - CRUD</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>client.controller.ts</code></td>
    <td><code>/clients</code></td>
    <td>+ licenseExpiryDate obligatoire</td>
  </tr>
  <tr>
    <td>Maintenance - CRUD</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>maintenance.controller.ts</code></td>
    <td><code>/maintenance</code></td>
    <td>+ documentUrl</td>
  </tr>
  <tr>
    <td>Fines - CRUD</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>fine.controller.ts</code></td>
    <td><code>/fines</code></td>
    <td>+ attachmentUrl</td>
  </tr>
  <tr>
    <td>Upload - Files</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>upload.controller.ts:56-93</code></td>
    <td><code>POST /upload</code></td>
    <td>10MB max, images + PDF</td>
  </tr>
  <tr>
    <td>Invoices</td>
    <td class="status-partiel">‚ö†Ô∏è PARTIEL</td>
    <td><code>invoice.controller.ts</code>, <code>invoice.service.ts</code></td>
    <td><code>/invoices</code></td>
    <td>Record DB + num√©ro incr√©mental par agence. PDF : MANQUE. Envoi email facture : non.</td>
  </tr>
  <tr>
    <td>Company Governance</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>company.controller.ts:38-43</code>, <code>schema.prisma:227-279</code></td>
    <td><code>GET /companies/me</code></td>
    <td>raisonSociale, identifiantLegal, formeJuridique, maxAgencies</td>
  </tr>
  <tr>
    <td>Modules - Management</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>module.controller.ts:24-86</code></td>
    <td><code>/modules</code></td>
    <td>activate/deactivate company + agency</td>
  </tr>
  <tr>
    <td>BusinessEventLog</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>business-event-log.service.ts</code></td>
    <td>Via services</td>
    <td>37 event types dans schema</td>
  </tr>
  <tr>
    <td>CORS</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>main.ts:16-100</code></td>
    <td>Global</td>
    <td>FRONTEND_URL, FRONTEND_AGENCY_URL, FRONTEND_ADMIN_URL, MOBILE_WEB_URL</td>
  </tr>
  <tr>
    <td>Notifications - Email</td>
    <td class="status-partiel">‚ö†Ô∏è PARTIEL</td>
    <td><code>email.service.ts</code></td>
    <td>Via services</td>
    <td>Nodemailer configur√©, requires SMTP env</td>
  </tr>
  <tr>
    <td>Notifications - WhatsApp</td>
    <td class="status-stub">‚ö†Ô∏è STUB</td>
    <td><code>whatsapp.service.ts</code></td>
    <td>Via services</td>
    <td>Placeholders, non fonctionnel</td>
  </tr>
  <tr>
    <td>Payment CMI</td>
    <td class="status-stub">‚ö†Ô∏è STUB</td>
    <td><code>payment.service.ts</code></td>
    <td><code>/payment</code></td>
    <td>Structure pr√©sente, non connect√©</td>
  </tr>
  <tr>
    <td>AI (Vision) ‚Äì D√©tection dommages</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>ai.controller.ts</code>, <code>damage-detection.service.ts</code></td>
    <td><code>POST /ai/damage/detect</code>, <code>POST /ai/damage/detect-batch</code></td>
    <td>OpenAI + Google Vision. OCR permis : non. VISION_API_KEY / GOOGLE_VISION_API_KEY.</td>
  </tr>
</table>

<h3>2.2 FRONTEND-ADMIN (Port 5173)</h3>

<table>
  <tr>
    <th>Module / Feature</th>
    <th>Statut</th>
    <th>Preuve (fichiers)</th>
    <th>Notes</th>
  </tr>
  <tr>
    <td>Login</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>pages/Login.tsx</code></td>
    <td>JWT auth</td>
  </tr>
  <tr>
    <td>Forgot Password</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>pages/ForgotPassword.tsx</code></td>
    <td>Nouveau Sprint 1</td>
  </tr>
  <tr>
    <td>Reset Password</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>pages/ResetPassword.tsx</code></td>
    <td>Nouveau Sprint 1</td>
  </tr>
  <tr>
    <td>Dashboard</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>pages/Dashboard.tsx</code></td>
    <td>Stats basiques</td>
  </tr>
  <tr>
    <td>Companies CRUD</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>pages/Companies.tsx</code></td>
    <td>+ raisonSociale, formeJuridique</td>
  </tr>
  <tr>
    <td>Agencies CRUD</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>pages/Agencies.tsx</code></td>
    <td>Via company filter</td>
  </tr>
  <tr>
    <td>Users CRUD</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>pages/Users.tsx</code></td>
    <td>+ role, agencies</td>
  </tr>
  <tr>
    <td>Subscriptions</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>pages/Subscriptions.tsx</code></td>
    <td>Plans, status</td>
  </tr>
  <tr>
    <td>Planning</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>pages/Planning.tsx</code>, <code>components/PlanningBoard.tsx</code></td>
    <td>Custom, pas FullCalendar</td>
  </tr>
  <tr>
    <td>CompanyHealth</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>pages/CompanyHealth.tsx</code></td>
    <td>Monitoring status</td>
  </tr>
  <tr>
    <td>Module 403 UI</td>
    <td class="status-partiel">‚ö†Ô∏è PARTIEL</td>
    <td>-</td>
    <td>Admin / Agency : non. Web : oui (isModuleError + messages). Mobile : partiel (check-in/out).</td>
  </tr>
</table>

<h3>2.3 FRONTEND-AGENCY (Port 8080)</h3>

<table>
  <tr>
    <th>Module / Feature</th>
    <th>Statut</th>
    <th>Preuve (fichiers)</th>
    <th>Notes</th>
  </tr>
  <tr>
    <td>Login</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>pages/Login.tsx</code></td>
    <td>JWT auth</td>
  </tr>
  <tr>
    <td>Forgot Password</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>pages/ForgotPassword.tsx</code></td>
    <td>Nouveau Sprint 1</td>
  </tr>
  <tr>
    <td>Reset Password</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>pages/ResetPassword.tsx</code></td>
    <td>Nouveau Sprint 1</td>
  </tr>
  <tr>
    <td>Vehicles CRUD</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>pages/Vehicles.tsx</code></td>
    <td>+ imageUpload, color</td>
  </tr>
  <tr>
    <td>Clients CRUD</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>pages/Clients.tsx</code></td>
    <td>+ licenseImageUrl</td>
  </tr>
  <tr>
    <td>Bookings CRUD</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>pages/Bookings.tsx</code></td>
    <td>Status transitions</td>
  </tr>
  <tr>
    <td>Planning</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>pages/Planning.tsx</code>, <code>components/PlanningBoard.tsx</code></td>
    <td>Custom, day/week/month</td>
  </tr>
  <tr>
    <td>Fines</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>pages/Fines.tsx</code></td>
    <td>+ attachmentUrl</td>
  </tr>
  <tr>
    <td>Maintenance</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>pages/Maintenance.tsx</code></td>
    <td>+ documentUrl</td>
  </tr>
</table>

<h3>2.4 MOBILE-AGENT (Port 8081 web / Expo)</h3>

<table>
  <tr>
    <th>Module / Feature</th>
    <th>Statut</th>
    <th>Preuve (fichiers)</th>
    <th>Notes</th>
  </tr>
  <tr>
    <td>Language Selection</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>screens/LanguageSelectionScreen.tsx</code></td>
    <td>FR, EN, Darija</td>
  </tr>
  <tr>
    <td>Login</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>screens/LoginScreen.tsx</code></td>
    <td>+ error messages am√©lior√©s Sprint 1</td>
  </tr>
  <tr>
    <td>Forgot Password</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>screens/ForgotPasswordScreen.tsx</code></td>
    <td>Nouveau Sprint 1</td>
  </tr>
  <tr>
    <td>Bookings List</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>screens/BookingsScreen.tsx</code></td>
    <td>Filter by status, search</td>
  </tr>
  <tr>
    <td>Check-In</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>screens/CheckInScreen.tsx</code></td>
    <td>Photos, signature, odom√®tre</td>
  </tr>
  <tr>
    <td>Check-Out</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>screens/CheckOutScreen.tsx</code></td>
    <td>Photos, signature, damages</td>
  </tr>
  <tr>
    <td>Offline Queue</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>services/offline.service.ts</code></td>
    <td>SQLite + localStorage fallback</td>
  </tr>
  <tr>
    <td>Offline Dedup</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>services/offline.service.ts:180-224</code></td>
    <td>Nouveau Sprint 1 - √©vite accumulation</td>
  </tr>
  <tr>
    <td>Sync Service</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>services/sync.service.ts</code></td>
    <td>Auto-sync 30s, NetInfo</td>
  </tr>
  <tr>
    <td>i18n</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>i18n/fr.json, en.json, darija.json</code></td>
    <td>3 langues</td>
  </tr>
</table>

<div class="page-break"></div>

<h2>3. ENDPOINTS BACKEND (Liste compl√®te)</h2>

<h3>3.1 Routes /api/v1 expos√©es</h3>

<table>
  <tr>
    <th>Controller</th>
    <th>Endpoints</th>
    <th>Guards</th>
  </tr>
  <tr>
    <td><strong>auth</strong></td>
    <td><code>POST /login</code>, <code>POST /refresh</code>, <code>GET /me</code>, <code>POST /forgot-password</code>, <code>POST /reset-password</code></td>
    <td>JwtAuthGuard (me)</td>
  </tr>
  <tr>
    <td><strong>planning</strong></td>
    <td><code>GET /</code>, <code>POST /check-availability</code>, <code>GET /next-availability/:vehicleId</code>, <code>POST /preparation-time</code></td>
    <td>JwtAuthGuard</td>
  </tr>
  <tr>
    <td><strong>bookings</strong></td>
    <td><code>GET /</code>, <code>GET /:id</code>, <code>POST /</code>, <code>PATCH /:id</code>, <code>DELETE /:id</code>, <code>POST /:id/checkin</code>, <code>POST /:id/checkout</code>, <code>POST /:id/financial-closure</code>, <code>PATCH /:id/late-fee</code></td>
    <td>JwtAuthGuard, RequireModuleGuard(BOOKINGS), PermissionGuard</td>
  </tr>
  <tr>
    <td><strong>vehicles</strong></td>
    <td><code>GET /</code>, <code>GET /:id</code>, <code>POST /</code>, <code>PATCH /:id</code>, <code>DELETE /:id</code></td>
    <td>JwtAuthGuard, RequireModuleGuard(VEHICLES)</td>
  </tr>
  <tr>
    <td><strong>clients</strong></td>
    <td><code>GET /</code>, <code>GET /:id</code>, <code>POST /</code>, <code>PATCH /:id</code>, <code>DELETE /:id</code></td>
    <td>JwtAuthGuard</td>
  </tr>
  <tr>
    <td><strong>maintenance</strong></td>
    <td><code>GET /</code>, <code>GET /:id</code>, <code>POST /</code>, <code>PATCH /:id</code>, <code>DELETE /:id</code></td>
    <td>JwtAuthGuard, RequireModuleGuard(MAINTENANCE)</td>
  </tr>
  <tr>
    <td><strong>fines</strong></td>
    <td><code>GET /</code>, <code>GET /:id</code>, <code>POST /</code>, <code>PATCH /:id</code>, <code>DELETE /:id</code></td>
    <td>JwtAuthGuard, RequireModuleGuard(FINES)</td>
  </tr>
  <tr>
    <td><strong>companies</strong></td>
    <td><code>GET /</code>, <code>GET /me</code>, <code>GET /:id</code>, <code>POST /</code>, <code>PATCH /:id</code>, <code>DELETE /:id</code></td>
    <td>JwtAuthGuard, RolesGuard</td>
  </tr>
  <tr>
    <td><strong>agencies</strong></td>
    <td><code>GET /</code>, <code>GET /:id</code>, <code>POST /</code>, <code>PATCH /:id</code>, <code>DELETE /:id</code></td>
    <td>JwtAuthGuard, RolesGuard</td>
  </tr>
  <tr>
    <td><strong>users</strong></td>
    <td><code>GET /</code>, <code>GET /:id</code>, <code>POST /</code>, <code>PATCH /:id</code>, <code>DELETE /:id</code></td>
    <td>JwtAuthGuard, RolesGuard</td>
  </tr>
  <tr>
    <td><strong>modules</strong></td>
    <td><code>GET /company/:companyId</code>, <code>GET /agency/:agencyId</code>, <code>GET /dependencies</code>, <code>POST /company/:companyId/:moduleCode/activate</code>, etc.</td>
    <td>JwtAuthGuard, RolesGuard</td>
  </tr>
  <tr>
    <td><strong>upload</strong></td>
    <td><code>POST /</code></td>
    <td>JwtAuthGuard</td>
  </tr>
</table>

<h3>3.2 Utilisation par frontend</h3>

<table>
  <tr>
    <th>Endpoint</th>
    <th>Admin</th>
    <th>Agency</th>
    <th>Web</th>
    <th>Mobile</th>
  </tr>
  <tr>
    <td><code>/auth/*</code></td>
    <td>‚úÖ</td>
    <td>‚úÖ</td>
    <td>‚úÖ</td>
    <td>‚úÖ</td>
  </tr>
  <tr>
    <td><code>/planning</code></td>
    <td>‚úÖ</td>
    <td>‚úÖ</td>
    <td>‚úÖ</td>
    <td>‚ùå</td>
  </tr>
  <tr>
    <td><code>/bookings</code></td>
    <td>‚ùå</td>
    <td>‚úÖ</td>
    <td>‚úÖ</td>
    <td>‚úÖ</td>
  </tr>
  <tr>
    <td><code>/bookings/:id/checkin</code></td>
    <td>‚ùå</td>
    <td>‚ùå</td>
    <td>‚ùå</td>
    <td>‚úÖ</td>
  </tr>
  <tr>
    <td><code>/bookings/:id/checkout</code></td>
    <td>‚ùå</td>
    <td>‚ùå</td>
    <td>‚ùå</td>
    <td>‚úÖ</td>
  </tr>
  <tr>
    <td><code>/vehicles</code></td>
    <td>‚ùå</td>
    <td>‚úÖ</td>
    <td>‚úÖ</td>
    <td>‚úÖ (read)</td>
  </tr>
  <tr>
    <td><code>/clients</code></td>
    <td>‚ùå</td>
    <td>‚úÖ</td>
    <td>‚úÖ</td>
    <td>‚úÖ (read)</td>
  </tr>
  <tr>
    <td><code>/companies</code></td>
    <td>‚úÖ</td>
    <td>‚ùå</td>
    <td>‚úÖ</td>
    <td>‚ùå</td>
  </tr>
  <tr>
    <td><code>/upload</code></td>
    <td>‚ùå</td>
    <td>‚úÖ</td>
    <td>‚úÖ</td>
    <td>‚úÖ</td>
  </tr>
</table>

<div class="page-break"></div>

<h2>4. CONFIGURATION / ENV</h2>

<h3>4.1 Variables indispensables (local dev)</h3>

<pre>
# Database (obligatoire)
DATABASE_URL="postgresql://postgres:password@localhost:5432/malocauto?schema=public"

# JWT (obligatoire)
JWT_SECRET=&lt;64+ caract√®res&gt;
JWT_ACCESS_EXPIRES_IN=15m
JWT_REFRESH_SECRET=&lt;64+ caract√®res&gt;
JWT_REFRESH_EXPIRES_IN=7d

# Server
PORT=3000
NODE_ENV=development

# CORS (obligatoire pour les 4 frontends)
FRONTEND_URL=http://localhost:3001
FRONTEND_ADMIN_URL=http://localhost:5173
FRONTEND_AGENCY_URL=http://localhost:8080
MOBILE_WEB_URL=http://localhost:8081

# Email (requis pour forgot-password)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=&lt;email&gt;
SMTP_PASS=&lt;app-password&gt;
SMTP_FROM=noreply@malocauto.com
</pre>

<h3>4.2 Variables optionnelles</h3>

<table>
  <tr>
    <th>Variable</th>
    <th>Usage</th>
    <th>Statut V1</th>
  </tr>
  <tr>
    <td><code>UPLOAD_PATH</code></td>
    <td>Chemin stockage images</td>
    <td>Optionnel (default: backend/uploads/)</td>
  </tr>
  <tr>
    <td><code>S3_*</code></td>
    <td>Stockage S3</td>
    <td>Non utilis√©</td>
  </tr>
  <tr>
    <td><code>CMI_*</code></td>
    <td>Paiement CMI</td>
    <td>Non utilis√©</td>
  </tr>
  <tr>
    <td><code>WHATSAPP_*</code></td>
    <td>Notifications WhatsApp</td>
    <td>Non utilis√©</td>
  </tr>
  <tr>
    <td><code>OPENAI_API_KEY</code></td>
    <td>AI services</td>
    <td>Non utilis√©</td>
  </tr>
  <tr>
    <td><code>VISION_API_KEY</code></td>
    <td>Extraction permis</td>
    <td>Non utilis√©</td>
  </tr>
  <tr>
    <td><code>READ_ONLY_MODE</code></td>
    <td>Mode maintenance</td>
    <td>false par d√©faut</td>
  </tr>
</table>

<div class="page-break"></div>

<h2>5. LIVRABLES</h2>

<h3>A) Mini-report EXISTE/MANQUE</h3>

<table>
  <tr>
    <th>Feature</th>
    <th>Statut</th>
    <th>Preuve</th>
  </tr>
  <tr>
    <td>Login + JWT</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>auth.controller.ts</code>, tous frontends</td>
  </tr>
  <tr>
    <td>Refresh Token</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>auth.service.ts</code>, RefreshToken model</td>
  </tr>
  <tr>
    <td>Forgot Password</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>forgot-password.dto.ts</code>, 4 frontends</td>
  </tr>
  <tr>
    <td>Reset Password</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>reset-password.dto.ts</code>, 4 frontends</td>
  </tr>
  <tr>
    <td>RBAC (Roles)</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td>RolesGuard, 4 roles</td>
  </tr>
  <tr>
    <td>RBAC (Permissions)</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td>PermissionGuard, READ/WRITE/FULL</td>
  </tr>
  <tr>
    <td>RequireModuleGuard</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>require-module.guard.ts</code></td>
  </tr>
  <tr>
    <td>ReadOnlyGuard</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>read-only.guard.ts</code></td>
  </tr>
  <tr>
    <td>Company Governance</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td>raisonSociale, identifiantLegal, formeJuridique, maxAgencies</td>
  </tr>
  <tr>
    <td>Company /me</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>company.controller.ts:38-43</code></td>
  </tr>
  <tr>
    <td>PlanningBoard custom</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td>4 composants identiques</td>
  </tr>
  <tr>
    <td>FullCalendar</td>
    <td class="status-manque">‚ùå SUPPRIM√â</td>
    <td>Remplac√© Sprint 1</td>
  </tr>
  <tr>
    <td>Booking rules R1.3 (permis)</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>booking.service.ts:70-105, 296-350</code></td>
  </tr>
  <tr>
    <td>Booking rules R2.2 (pr√©paration)</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>booking.service.ts:120-170</code></td>
  </tr>
  <tr>
    <td>Booking rules R3 (caution)</td>
    <td class="status-partiel">‚ö†Ô∏è PARTIEL</td>
    <td>Fields pr√©sents, validation manuelle</td>
  </tr>
  <tr>
    <td>Booking rules R4 (retard)</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>booking.service.ts:536-562</code></td>
  </tr>
  <tr>
    <td>Booking rules R5 (dommages/litiges)</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>booking.service.ts:1034-1067</code></td>
  </tr>
  <tr>
    <td>Booking rules R6 (facture)</td>
    <td class="status-partiel">‚ö†Ô∏è PARTIEL</td>
    <td>Record Invoice DB + num√©ro par agence. Pas PDF ni email.</td>
  </tr>
  <tr>
    <td>Upload files</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>upload.controller.ts</code>, images + PDF</td>
  </tr>
  <tr>
    <td>Offline queue (mobile)</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>offline.service.ts</code></td>
  </tr>
  <tr>
    <td>Offline dedup</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>offline.service.ts:180-224</code> (Sprint 1)</td>
  </tr>
  <tr>
    <td>BusinessEventLog</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>business-event-log.service.ts</code>, 37 event types</td>
  </tr>
  <tr>
    <td>CORS multi-frontend</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>main.ts:16-100</code></td>
  </tr>
  <tr>
    <td>2FA</td>
    <td class="status-manque">‚ùå MANQUE</td>
    <td>Fields pr√©sents, UI/flow non impl√©ment√©</td>
  </tr>
  <tr>
    <td>WhatsApp notifications</td>
    <td class="status-stub">‚ùå STUB</td>
    <td>Placeholders only</td>
  </tr>
  <tr>
    <td>CMI Payment</td>
    <td class="status-stub">‚ùå STUB</td>
    <td>Structure only</td>
  </tr>
  <tr>
    <td>AI Vision ‚Äì D√©tection dommages</td>
    <td class="status-existe">‚úÖ EXISTE</td>
    <td><code>POST /ai/damage/detect</code>, <code>damage-detection.service</code>. OCR permis : non.</td>
  </tr>
  <tr>
    <td>PDF Invoice</td>
    <td class="status-manque">‚ùå MANQUE</td>
    <td>Record DB + num√©ro par agence. Pas de PDF ni envoi email.</td>
  </tr>
</table>

<div class="page-break"></div>

<h3>B) Release Notes V1</h3>

<h4>MalocAuto V1.0.0 - 28 janvier 2026</h4>

<h4>Inclus dans cette version</h4>

<p><strong>Backend</strong></p>
<ul>
  <li>‚úÖ Authentification compl√®te (login, refresh, forgot/reset password)</li>
  <li>‚úÖ RBAC avec 4 r√¥les et 3 niveaux de permission</li>
  <li>‚úÖ Guards: RequireModuleGuard, RequireActiveCompanyGuard, RequireActiveAgencyGuard, ReadOnlyGuard</li>
  <li>‚úÖ Gestion Companies avec governance (raisonSociale, identifiantLegal, formeJuridique, maxAgencies)</li>
  <li>‚úÖ Gestion Agencies avec timezone et preparationTimeMinutes</li>
  <li>‚úÖ Gestion Users avec multi-agences</li>
  <li>‚úÖ Gestion Vehicles avec images et couleurs</li>
  <li>‚úÖ Gestion Clients avec validation permis (R1.3)</li>
  <li>‚úÖ Gestion Bookings avec check-in/check-out, r√®gles m√©tier (R1.3, R2.2, R4, R5)</li>
  <li>‚úÖ Planning centralis√© avec d√©tection conflits</li>
  <li>‚úÖ Maintenance, Fines, Incidents</li>
  <li>‚úÖ Modules SaaS activables par Company/Agency</li>
  <li>‚úÖ Subscriptions avec scheduler suspend/delete</li>
  <li>‚úÖ Upload fichiers (images, PDF) jusqu'√† 10MB</li>
  <li>‚úÖ BusinessEventLog (37 event types)</li>
  <li>‚úÖ AuditLog avec timestamps</li>
  <li>‚úÖ CORS multi-frontend configur√©</li>
</ul>

<p><strong>Frontend-Admin (SuperAdmin)</strong></p>
<ul>
  <li>‚úÖ Dashboard, Companies, Agencies, Users, Subscriptions</li>
  <li>‚úÖ Planning unifi√© (PlanningBoard custom)</li>
  <li>‚úÖ Forgot/Reset password</li>
</ul>

<p><strong>Frontend-Agency</strong></p>
<ul>
  <li>‚úÖ Dashboard, Vehicles, Clients, Bookings, Maintenance, Fines</li>
  <li>‚úÖ Planning unifi√© (PlanningBoard custom)</li>
  <li>‚úÖ Upload images v√©hicules/permis</li>
  <li>‚úÖ Forgot/Reset password</li>
</ul>

<p><strong>Frontend-Web (Next.js)</strong></p>
<ul>
  <li>‚úÖ Admin, Company, Agency sections compl√®tes</li>
  <li>‚úÖ Planning unifi√© (PlanningBoard custom)</li>
  <li>‚úÖ Forgot/Reset password</li>
</ul>

<p><strong>Mobile-Agent (React Native / Expo)</strong></p>
<ul>
  <li>‚úÖ Login avec 3 langues (FR, EN, Darija)</li>
  <li>‚úÖ Liste bookings avec filtres</li>
  <li>‚úÖ Check-in avec photos, signature, odom√®tre, dommages</li>
  <li>‚úÖ Check-out avec photos, signature, frais, dommages</li>
  <li>‚úÖ Offline queue avec SQLite (+ localStorage fallback web)</li>
  <li>‚úÖ D√©duplication actions offline (Sprint 1)</li>
  <li>‚úÖ Sync automatique toutes les 30s</li>
  <li>‚úÖ Forgot password</li>
</ul>

<h4>Explicitement hors scope V1</h4>
<ul>
  <li>‚ùå 2FA (champs pr√©sents, UI non impl√©ment√©e)</li>
  <li>‚ùå Paiement CMI (structure stub)</li>
  <li>‚ùå WhatsApp notifications (stub)</li>
  <li>‚ùå OCR / extraction permis (non impl√©ment√©)</li>
  <li>‚ùå G√©n√©ration PDF factures (DB + num√©ro uniquement)</li>
  <li>‚ùå S3 storage (utilise stockage local)</li>
  <li>‚ùå Push notifications mobile</li>
</ul>

<div class="page-break"></div>

<h3>C) Checklist de tests manuels V1</h3>

<h4>Backend API (via Swagger /api/docs ou curl)</h4>

<table>
  <tr>
    <th>#</th>
    <th>Test</th>
    <th>R√©sultat attendu</th>
  </tr>
  <tr>
    <td>1</td>
    <td><code>POST /auth/login</code> avec credentials valides</td>
    <td>200 + access_token + refresh_token</td>
  </tr>
  <tr>
    <td>2</td>
    <td><code>POST /auth/login</code> avec mauvais password</td>
    <td>401 + "Mot de passe incorrect"</td>
  </tr>
  <tr>
    <td>3</td>
    <td><code>POST /auth/forgot-password</code> avec email existant</td>
    <td>200 + email envoy√© (si SMTP)</td>
  </tr>
  <tr>
    <td>4</td>
    <td><code>POST /auth/refresh</code> avec refresh_token valide</td>
    <td>200 + nouveau access_token</td>
  </tr>
  <tr>
    <td>5</td>
    <td><code>GET /auth/me</code> avec Bearer token</td>
    <td>200 + user info</td>
  </tr>
  <tr>
    <td>6</td>
    <td><code>GET /companies</code> en tant que SUPER_ADMIN</td>
    <td>200 + liste companies</td>
  </tr>
  <tr>
    <td>7</td>
    <td><code>GET /companies/me</code> en tant que COMPANY_ADMIN</td>
    <td>200 + ma company</td>
  </tr>
  <tr>
    <td>8</td>
    <td><code>POST /bookings</code> avec permis expir√© avant endDate</td>
    <td>400 + "permis expire avant fin location"</td>
  </tr>
  <tr>
    <td>9</td>
    <td><code>POST /bookings/:id/checkin</code> avec permis expir√©</td>
    <td>400 + "check-in impossible"</td>
  </tr>
  <tr>
    <td>10</td>
    <td><code>POST /bookings/:id/checkout</code> en retard 1h30</td>
    <td>200 + lateFeeAmount = 50% dailyRate</td>
  </tr>
  <tr>
    <td>11</td>
    <td><code>POST /bookings/:id/financial-closure</code> avec incident DISPUTED</td>
    <td>400 + "litige en cours"</td>
  </tr>
  <tr>
    <td>12</td>
    <td><code>POST /upload</code> avec image JPG 5MB</td>
    <td>200 + url fichier</td>
  </tr>
  <tr>
    <td>13</td>
    <td><code>GET /planning?agencyId=xxx</code></td>
    <td>200 + resources + events</td>
  </tr>
  <tr>
    <td>14</td>
    <td><code>POST /planning/check-availability</code> p√©riode occup√©e</td>
    <td>200 + available:false + conflicts</td>
  </tr>
  <tr>
    <td>15</td>
    <td>Appel <code>/bookings</code> sans module BOOKINGS activ√©</td>
    <td>403 + "Module BOOKINGS not included"</td>
  </tr>
</table>

<h4>Frontend-Admin</h4>

<table>
  <tr>
    <th>#</th>
    <th>Test</th>
    <th>R√©sultat attendu</th>
  </tr>
  <tr>
    <td>1</td>
    <td>Login admin@malocauto.com</td>
    <td>Redirect dashboard</td>
  </tr>
  <tr>
    <td>2</td>
    <td>Cr√©er une Company</td>
    <td>Company cr√©√©e avec slug</td>
  </tr>
  <tr>
    <td>3</td>
    <td>Activer module BOOKINGS pour Company</td>
    <td>Module activ√©</td>
  </tr>
  <tr>
    <td>4</td>
    <td>Voir planning</td>
    <td>PlanningBoard affiche v√©hicules</td>
  </tr>
  <tr>
    <td>5</td>
    <td>Forgot password</td>
    <td>Email re√ßu (si SMTP)</td>
  </tr>
</table>

<h4>Frontend-Agency</h4>

<table>
  <tr>
    <th>#</th>
    <th>Test</th>
    <th>R√©sultat attendu</th>
  </tr>
  <tr>
    <td>1</td>
    <td>Login agent</td>
    <td>Redirect dashboard agence</td>
  </tr>
  <tr>
    <td>2</td>
    <td>Cr√©er v√©hicule avec image</td>
    <td>V√©hicule + imageUrl</td>
  </tr>
  <tr>
    <td>3</td>
    <td>Cr√©er client avec permis</td>
    <td>Client + licenseExpiryDate</td>
  </tr>
  <tr>
    <td>4</td>
    <td>Cr√©er booking</td>
    <td>Booking status DRAFT</td>
  </tr>
  <tr>
    <td>5</td>
    <td>Voir planning jour/semaine/mois</td>
    <td>3 vues fonctionnelles</td>
  </tr>
  <tr>
    <td>6</td>
    <td>Drag & drop booking (m√™me v√©hicule)</td>
    <td>Update dates seulement. Changement de v√©hicule : non dispo V1.</td>
  </tr>
  <tr>
    <td>7</td>
    <td>Upload document maintenance</td>
    <td>Document attach√©</td>
  </tr>
</table>

<h4>Mobile-Agent (Web mode localhost:8081)</h4>

<table>
  <tr>
    <th>#</th>
    <th>Test</th>
    <th>R√©sultat attendu</th>
  </tr>
  <tr>
    <td>1</td>
    <td>S√©lection langue FR</td>
    <td>Interface en fran√ßais</td>
  </tr>
  <tr>
    <td>2</td>
    <td>Login agent</td>
    <td>Affiche liste bookings</td>
  </tr>
  <tr>
    <td>3</td>
    <td>Login mauvais password</td>
    <td>Message "Email ou mot de passe incorrect"</td>
  </tr>
  <tr>
    <td>4</td>
    <td>Check-in avec photos</td>
    <td>Transition CONFIRMED ‚Üí IN_PROGRESS</td>
  </tr>
  <tr>
    <td>5</td>
    <td>Check-out avec signature</td>
    <td>Transition IN_PROGRESS ‚Üí RETURNED</td>
  </tr>
  <tr>
    <td>6</td>
    <td>Mode offline (couper r√©seau)</td>
    <td>Badge "X en attente de synchro"</td>
  </tr>
  <tr>
    <td>7</td>
    <td>Cliquer 3x sur check-in offline</td>
    <td>Compteur reste √† 1 (dedup)</td>
  </tr>
  <tr>
    <td>8</td>
    <td>Reconnecter</td>
    <td>Sync automatique, compteur ‚Üí 0</td>
  </tr>
</table>

<div class="page-break"></div>

<h3>D) Risques / Tech Debt</h3>

<table>
  <tr>
    <th>Priorit√©</th>
    <th>Risque</th>
    <th>Description</th>
    <th>Fichiers concern√©s</th>
  </tr>
  <tr class="priority-critical">
    <td>üî¥ Critical</td>
    <td>SMTP non configur√©</td>
    <td>Forgot password silently fails</td>
    <td><code>email.service.ts</code></td>
  </tr>
  <tr class="priority-critical">
    <td>üî¥ Critical</td>
    <td>JWT secrets faibles en prod</td>
    <td>Risque s√©curit√© si non chang√©s</td>
    <td><code>backend/.env</code>, <code>jwt.ts</code></td>
  </tr>
  <tr class="priority-high">
    <td>üü† High</td>
    <td>Pas de 2FA</td>
    <td>UI non impl√©ment√©e</td>
    <td><code>user.controller.ts</code></td>
  </tr>
  <tr class="priority-high">
    <td>üü† High</td>
    <td>Pas de PDF factures</td>
    <td>Record DB + num√©ro par agence. Pas de PDF ni email.</td>
    <td><code>invoice.service.ts</code></td>
  </tr>
  <tr class="priority-high">
    <td>üü† High</td>
    <td>403 modules : Admin / Agency sans UI d√©di√©e</td>
    <td>Web oui, Mobile partiel. Admin/Agency : pas de page 403 modules.</td>
    <td>frontend-admin, frontend-agency</td>
  </tr>
  <tr class="priority-medium">
    <td>üü° Medium</td>
    <td>WhatsApp stub</td>
    <td>Non fonctionnel</td>
    <td><code>whatsapp.service.ts</code></td>
  </tr>
  <tr class="priority-medium">
    <td>üü° Medium</td>
    <td>CMI stub</td>
    <td>Non fonctionnel</td>
    <td><code>payment.service.ts</code></td>
  </tr>
  <tr class="priority-medium">
    <td>üü° Medium</td>
    <td>OCR permis non impl√©ment√©</td>
    <td>D√©tection dommages OK. Pas d‚Äôextraction permis.</td>
    <td><code>ai.controller.ts</code></td>
  </tr>
  <tr class="priority-medium">
    <td>üü° Medium</td>
    <td>Analytics peu rempli</td>
    <td>Peu de valeur</td>
    <td><code>analytics.controller.ts</code></td>
  </tr>
  <tr class="priority-low">
    <td>üü¢ Low</td>
    <td>Pas de S3</td>
    <td>Stockage local uniquement</td>
    <td><code>upload.controller.ts</code></td>
  </tr>
  <tr class="priority-low">
    <td>üü¢ Low</td>
    <td>Pas de push notifications</td>
    <td>Mobile sans push</td>
    <td><code>mobile-agent/</code></td>
  </tr>
  <tr class="priority-low">
    <td>üü¢ Low</td>
    <td>Tests E2E partiels</td>
    <td>Couverture limit√©e</td>
    <td><code>backend/test/</code></td>
  </tr>
</table>

<h3>Changelog (mise √† jour coh√©rente avec le code)</h3>

<table>
  <tr>
    <th>√âl√©ment</th>
    <th>Correction</th>
  </tr>
  <tr>
    <td>AI Vision</td>
    <td>D√©tection dommages impl√©ment√©e (OpenAI + Google). OCR permis : non. Endpoints <code>/ai/damage/detect</code>, <code>/ai/damage/detect-batch</code>.</td>
  </tr>
  <tr>
    <td>Invoice</td>
    <td>Record DB + num√©ro incr√©mental par agence. PDF : MANQUE. Envoi email facture : non.</td>
  </tr>
  <tr>
    <td>Statuts booking</td>
    <td>Enum exact : DRAFT, PENDING, CONFIRMED, IN_PROGRESS, EXTENDED, LATE, RETURNED, CANCELLED, NO_SHOW. Flows : create‚ÜíDRAFT; check-in CONFIRMED‚ÜíIN_PROGRESS; check-out IN_PROGRESS/LATE‚ÜíRETURNED.</td>
  </tr>
  <tr>
    <td>Drag &amp; drop planning</td>
    <td>Impl√©ment√© pour modification dates (m√™me v√©hicule). Changement de v√©hicule via planning : non disponible V1 (<code>UpdateBookingDto</code> sans <code>vehicleId</code>).</td>
  </tr>
  <tr>
    <td>403 modules UI</td>
    <td>Web : isModuleError + messages. Admin, Agency, Mobile (hors check-in/out) : message standard &quot;Ce module n'est pas activ√© pour votre compte.&quot;</td>
  </tr>
</table>

<h3>Stabilisation V1 (corrections appliqu√©es)</h3>

<table>
  <tr>
    <th>T√¢che</th>
    <th>Fichiers</th>
    <th>R√©sum√©</th>
  </tr>
  <tr>
    <td>R3 Caution</td>
    <td><code>booking.service.ts</code>, <code>business-rules.e2e-spec.ts</code></td>
    <td>Check-in refus√© (400) si <code>depositRequired</code> et <code>depositStatusCheckIn !== 'COLLECTED'</code>. Message : &quot;La caution doit √™tre collect√©e avant le check-in.&quot;</td>
  </tr>
  <tr>
    <td>Statuts UI</td>
    <td>frontend-agency (Bookings, Dashboard, Planning), frontend-web (bookings)</td>
    <td>IN_PROGRESS ‚Üí &quot;ACTIVE&quot;, RETURNED ‚Üí &quot;TERMIN√âE&quot; (FR). Harmonisation partout.</td>
  </tr>
  <tr>
    <td>Planning drag</td>
    <td><code>PlanningBoard</code> admin, agency, web</td>
    <td>Drag vers autre v√©hicule bloqu√©. Message : &quot;Vous pouvez uniquement modifier la date. Le changement de v√©hicule n'est pas disponible dans cette version.&quot;</td>
  </tr>
  <tr>
    <td>403 Module UX</td>
    <td>admin/agency <code>axios</code>, mobile <code>api.ts</code></td>
    <td>Message standard &quot;Ce module n'est pas activ√© pour votre compte.&quot; Mobile : hors check-in/check-out.</td>
  </tr>
  <tr>
    <td>AI Vision</td>
    <td>Doc uniquement</td>
    <td>Disponible c√¥t√© backend. Aucune int√©gration UI en V1. Lors de l‚Äôint√©gration future : afficher un message explicite si IA non configur√©e.</td>
  </tr>
</table>

<hr>

<p style="text-align: center; margin-top: 30px; color: #6b7280;">
  <strong>Fin du Release Report V1</strong><br>
  G√©n√©r√© le 28 janvier 2026 - MalocAuto. Align√© avec <code>REPONSES_QUESTIONS_V1.md</code>. Stabilisation V1 appliqu√©e.
</p>

</body>
</html>
